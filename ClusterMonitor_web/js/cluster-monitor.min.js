"use strict";var refreshtimer;function convtobyte(c){var b=c.split(" ");var a;switch(b[1]){case"KB":a=b[0]*1024;break;case"MB":a=b[0]*1024*1024;break;case"GB":a=b[0]*1024*1024*1024;break;case"TB":a=b[0]*1024*1024*1024*1024;break;default:a=b[0]}return a}function funcrefresh(){var a=$("li.active a.tab-link").attr("id");if(a==undefined){a=null}if(a=="Materiel"){var b=$("#tabmateriel>.tab-pane.active").attr("id")}else{if(a=="Quota"){var b=$("#tabquota>.tab-pane.active").attr("id")}else{if(a=="Configuration"){var b=$("#configbatch>.tab-pane.active").attr("id")}else{b=null}}}var c=location.hash.replace(/^#/,"");if(c.length<"1"){c="ajax/dashboard.php"}LoadAjaxContent(c,a,b,1)}function LoadAjaxContentMenu(c,b,d){if(c.split("?")[0]=="ajax/cluster.php"){var a=c.split("?")[1];if(b!=null){c="ajax/cluster/"+b+".php?"+a}else{c="ajax/cluster/General.php?"+a}}else{if(c.split("?")[0]=="ajax/tendances.php"){var a=c.split("?")[1];if(b!=null){c="ajax/tendances/"+b+".php?"+a}else{c="ajax/tendances/Tendance.php?"+a}}else{if(c.split("?")[0]=="ajax/jobs.php"){var a=c.split("?")[1];if(b!=null){c="ajax/tendances/"+b+".php?"+a}else{c="ajax/tendances/jobs.php?"+a}}}}if(a!=null){$("#preloader_mini").show()}else{$("#preloader_full").show()}setTimeout(function(){if(a!=null){if(d==null){var e;if(c.split("/")[1]=="cluster"){e="ajax/menu/menu_cluster.php?"+a}else{if(c.split("/")[1]=="tendances"){e="ajax/menu/menu_tendances.php?"+a}}$.ajax({mimeType:"text/html; charset=utf-8",url:e,type:"GET",success:function(f){$("#ajax-content-menu").removeClass("col-md-0");$("#ajax-content-menu").addClass("col-md-2");$("#ajax-content-menu").addClass("col-xs-12");$("#ajax-content").removeClass("col-md-12");$("#ajax-content").addClass("col-md-10");$("#ajax-content-menu").show();$("#preloader_mini").hide();$("#ajax-content-menu").html(f)},error:function(f,h,g){alert(g)},dataType:"html",async:false})}}else{$("#ajax-content-menu").hide();$("#ajax-content-menu").removeClass("col-md-2");$("#ajax-content-menu").removeClass("col-xs-12");$("#ajax-content-menu").addClass("col-md-0");$("#ajax-content").removeClass("col-md-10");$("#ajax-content").addClass("col-md-12")}$.ajax({mimeType:"text/html; charset=utf-8",url:c,type:"GET",success:function(f){$("#ajax-content").html(f);$("#preloader_full").hide()},error:function(f,h,g){alert(g)},dataType:"html",async:false})},5)}function LoadAjaxContent(c,b,e,d){if(c.split("?")[0]=="ajax/cluster.php"){var a=c.split("?")[1];c="ajax/cluster/General.php?"+a;if(b!=null){c="ajax/cluster/"+b+".php?"+a}}else{if(c.split("?")[0]=="ajax/tendances.php"){var a=c.split("?")[1];c="ajax/tendances/Tendance.php?"+a;if(b!=null){c="ajax/tendances/"+b+".php?"+a}}else{if(c.split("?")[0]=="ajax/jobs.php"){var a=c.split("?")[1];c="ajax/tendances/jobs.php?"+a;if(b!=null){c="ajax/tendances/"+b+".php?"+a}}}}if(d==null){if(a!=null){$("#preloader_mini").show()}else{$("#preloader_full").show()}}else{$.toaster({priority:"success",title:"Mise à jour",message:" en cours ..."})}setTimeout(function(){$.ajax({mimeType:"text/html; charset=utf-8",url:c,type:"GET",success:function(g){$("#ajax-content").html(g);if(d==null){if(a!=null){$("#preloader_mini").hide()}else{$("#preloader_full").hide()}}if(e!=null){var f=$('a[href="#'+e+'"]').parents("ul").attr("id");$("#"+f+' a[href="#'+e+'"]').tab("show")}},complete:function(){refreshtimer=setTimeout(funcrefresh,120000);var f=new Date()},error:function(f,h,g){alert(g)},dataType:"html",async:false})},50)}function SetMinBlockHeight(a){a.css("min-height",window.innerHeight-49)}function DashboardTabChecker(){$("#ajax-content-menu").on("click","a.tab-link",function(c){c.preventDefault();var a=$(this).attr("id");$(this).closest(".nav").find("li").removeClass("active");$(this).closest("li").addClass("active");$.ajax({url:"ajax/env/delenvsession.php",type:"POST",async:true,dataType:"html",});var b=location.hash.replace(/^#/,"");LoadAjaxContentMenu(b,a,1);if($("div.bootstrap-switch").hasClass("bootstrap-switch-on")){document.getElementById("refreshoff").click()}});$("#ajax-content").on("click","button#okjobid",function(c){c.preventDefault();var a="Jobshistory";$(this).closest(".nav").find("li").removeClass("active");$(this).closest("li").addClass("active");var b=location.hash.replace(/^#/,"");$.ajax({url:"ajax/env/envsession.php",type:"POST",async:true,data:{jobid:$("#jobid").val(),action:"okjobid"},dataType:"html",success:function(d){LoadAjaxContentMenu(b,a,1)},})});$("#ajax-content").on("click","a.jobidok",function(f){f.preventDefault();var a="Jobshistory";$(this).closest(".nav").find("li").removeClass("active");$(this).closest("li").addClass("active");var b=location.hash.replace(/^#/,"");var d=this.href.split("#");var c=d[1];$.ajax({url:"ajax/env/envsession.php",type:"POST",async:true,data:{jobid:c,action:"okjobid"},dataType:"html",success:function(e){LoadAjaxContentMenu(b,a,1)},})});$("#ajax-content").on("click","button#uftok",function(c){c.preventDefault();if(($("#userid").val()!="")&&($("#from").val()!="")&&($("#to").val()!="")){var a="Jobshistory";$(this).closest(".nav").find("li").removeClass("active");$(this).closest("li").addClass("active");var b=location.hash.replace(/^#/,"");$.ajax({url:"ajax/env/envsession.php",type:"POST",async:true,data:{jobid:$("#jobid").val(),userid:$("#userid").val(),from:$("#from").val(),to:$("#to").val(),action:"uftok"},dataType:"html",success:function(d){LoadAjaxContentMenu(b,a,1)},})}else{$.toaster({priority:"danger",title:"Recherche impossible",message:"il manque des informations"})}})}function OpenModalBox(d,b,a){var c=$("#modalbox");c.find(".modal-header-name span").html(d);c.find(".devoops-modal-inner").html(b);c.find(".devoops-modal-bottom").html(a);c.fadeIn("fast");$("body").addClass("body-expanded")}function CloseModalBox(){var a=$("#modalbox");a.fadeOut("fast",function(){a.find(".modal-header-name span").children().remove();a.find(".devoops-modal-inner").children().remove();a.find(".devoops-modal-bottom").children().remove();$("body").removeClass("body-expanded")})}(function(a){a.fn.beautyHover=function(){var b=this;b.on("mouseover","td",function(){var c=a(this).index();var d=a(this).closest("table").find("tr");d.each(function(){a(this).find("td:eq("+c+")").addClass("beauty-hover")})}).on("mouseleave","td",function(f){var c=a(this).index();var d=a(this).closest("table").find("tr");d.each(function(){a(this).find("td:eq("+c+")").removeClass("beauty-hover")})})}})(jQuery);$(document).ready(function(){$("body").on("click",".show-sidebar",function(c){c.preventDefault();$("div#main").toggleClass("sidebar-show");$("div#breadcrumb").toggleClass("col-lg-12")});var b="ajax/dashboard.php";LoadAjaxContent(b);$(".main-menu").on("click","a",function(j){var f=$(this).parents("li");var c=$(this).closest("li.dropdown");var i=$(".main-menu li").not(f);i.find("a").removeClass("active");i.find("a").removeClass("active-parent");if($(this).hasClass("dropdown-toggle")||$(this).closest("li").find("ul").length==0){$(this).addClass("active-parent");var h=$(this).next();if(h.is(":visible")){c.find("ul.dropdown-menu").slideUp("fast");c.find("ul.dropdown-menu a").removeClass("active")}else{i.find("ul.dropdown-menu").slideUp("fast");h.slideDown("fast")}}else{if(c.find("a.dropdown-toggle").hasClass("active-parent")){var g=$(this).closest("ul.dropdown-menu");g.find("li.dropdown").not($(this).closest("li")).find("ul.dropdown-menu").slideUp("fast")}}if($(this).hasClass("active")==false){$(this).parents("ul.dropdown-menu").find("a").removeClass("active");$(this).addClass("active")}if($(this).hasClass("ajax-link")){j.preventDefault();if($(this).hasClass("add-full")){$("#content").addClass("full-content")}else{$("#content").removeClass("full-content")}var d=$(this).attr("href");window.location.hash=d;LoadAjaxContentMenu(d)}if($(this).attr("href")=="#"){j.preventDefault()}});var a=window.innerHeight-49;$("#main").css("min-height",a).on("click",".expand-link",function(h){var c=$("body");h.preventDefault();var f=$(this).closest("div.box");var d=$(this).find("i");d.toggleClass("fa-expand").toggleClass("fa-compress");f.toggleClass("expanded");c.toggleClass("body-expanded");var g=0;if(c.hasClass("body-expanded")){g=100}setTimeout(function(){f.toggleClass("expanded-padding")},g);setTimeout(function(){f.resize();f.find("[id^=map-]").resize()},g+50)}).on("click",".collapse-link",function(g){g.preventDefault();var f=$(this).closest("div.box");var c=$(this).find("i");var d=f.find("div.box-content");d.slideToggle("fast");c.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down");setTimeout(function(){f.resize();f.find("[id^=map-]").resize()},50)}).on("click",".close-link",function(d){d.preventDefault();var c=$(this).closest("div.box");c.remove()});$("body").on("click","a.close-link",function(c){c.preventDefault();CloseModalBox()});$("#top-panel").on("click","a",function(d){if($(this).hasClass("ajax-link")){d.preventDefault();if($(this).hasClass("add-full")){$("#content").addClass("full-content")}else{$("#content").removeClass("full-content")}var c=$(this).attr("href");window.location.hash=c;LoadAjaxContentMenu(c)}});$(".about").on("click",function(){$("#about").toggleClass("about-h")});$("#about").on("mouseleave",function(){$("#about").removeClass("about-h")});$("#insertdata").on("click",function(){if($("#inputCluster").val()!=""){$.ajax({url:"ajax/login/insert.php",type:"POST",async:true,data:{Cluster:$("#inputCluster").val()},dataType:"html",success:function(c){$.toaster({priority:"success",title:"Insertion réussie",message:"L'insertion du calculateur "+$("#inputCluster").val()+" est faite"});setTimeout(function(){clearTimeout(refreshtimer);location.reload(true)},3000)},})}else{$.toaster({priority:"danger",title:"Insertion impossible",message:"L'insertion du calculateur "+$("#inputCluster").val()+" est imposssible"})}});$("#deletedata").on("click",function(){if($("#deleteCluster").val()!=""){$.ajax({url:"ajax/login/delete.php",type:"POST",async:true,data:{Cluster:$("#deleteCluster").val()},dataType:"html",success:function(c){$.toaster({priority:"success",title:"Suppression réussie",message:"La suppression du calculateur "+$("#deleteCluster").val()+" est faite"});setTimeout(function(){clearTimeout(refreshtimer);location.reload(true)},3000)},})}else{$.toaster({priority:"danger",title:"Suppression impossible",message:"La suppression du calculateur "+$("#deleteCluster").val()+" est imposssible"})}});$("#cleandata").on("click",function(){if($("#cleanCluster").val()!=""){$.ajax({url:"ajax/login/cleanCluster.php",type:"POST",async:true,data:{Cluster:$("#cleanCluster").val()},dataType:"html",success:function(c){$.toaster({priority:"success",title:"Suppression réussie",message:"La supression des données du calculateur "+$("#cleanCluster").val()+" est faite"});setTimeout(function(){clearTimeout(refreshtimer);location.reload(true)},3000)},})}else{$.toaster({priority:"danger",title:"Suppression impossible",message:"La supression des données du calculateur "+$("#cleanCluster").val()+" est imposssible"})}});$("#updatedata").on("click",function(){if($("#updateCluster").val()!=""){$.ajax({url:"ajax/login/update.php",type:"POST",async:true,data:{Cluster:$("#updateCluster").val()},dataType:"html",success:function(c){$.toaster({priority:"success",title:"Activation réussie",message:"L'activation du calculateur "+$("#updateCluster").val()+" est faite"});setTimeout(function(){clearTimeout(refreshtimer);location.reload(true)},3000)},})}else{$.toaster({priority:"danger",title:"Activation impossible",message:"L'activation du calculateur "+$("#updateCluster").val()+" est imposssible"})}});$("#gestionuser").on("click",function(){$("#tabs").tabs()});$("#createusers").on("click",function(){if(($("#llogin").val()!="")&&($("#mmdp").val()!="")&&($("#mmdp").val()==$("#Mdp2").val())&&($("#Nom").val()!="")&&($("#Prenom").val()!="")&&($("#Groupe").val()!="")){$.ajax({url:"ajax/login/create_users.php",type:"POST",async:true,data:{Login:$("#llogin").val(),Mdp:$("#mmdp").val(),Nom:$("#Nom").val(),Prenom:$("#Prenom").val(),Groupe:$("#Groupe").val()},dataType:"json",success:function(c){switch(c.data){case"ok":$.toaster({priority:"success",title:"Création utilisateur ",message:"ok"});setTimeout(function(){clearTimeout(refreshtimer);location.reload(true)},3000);break;case"already_exist":$.toaster({priority:"danger",title:"Création utilisateur ",message:"Login déjà existant !"});break;default:$.toaster({priority:"warning",title:"Création utilisateur ",message:"Erreur innatendu ! "})}},})}else{$.toaster({priority:"danger",title:"Connexion impossible",message:"Il manque des informations !"})}});$("#deleteusers").on("click",function(){if($("#idsuppr").val()!=""){$.ajax({url:"ajax/login/delete_users.php",type:"POST",async:true,data:{idsuppr:$("#idsuppr").val()},dataType:"json",success:function(c){switch(c.data){case"ok":$.toaster({priority:"success",title:"Suppréssion utilisateur ",message:"éffectué"});setTimeout(function(){clearTimeout(refreshtimer);location.reload(true)},3000);break;case"last_admin":$.toaster({priority:"danger",title:"Suppréssion utilisateur ",message:"Impossible il n'y a pas d'autre administrateur !"});break;default:$.toaster({priority:"warning",title:"Création utilisateur ",message:"Erreur innatendu ! "})}},})}else{$.toaster({priority:"danger",title:"Connexion impossible",message:"Il manque des informations !"})}});$("#login").on("click",function(){if(($("#LLogin").val()!="")&&($("#MMdp").val()!="")){$.ajax({url:"ajax/login/login.php",type:"POST",async:true,data:{Login:$("#LLogin").val(),Mdp:$("#MMdp").val()},dataType:"json",success:function(c){if(c.data=="ok"){$.toaster({priority:"success",title:"Connexion réussie",message:"Vous êtes maintenant connecté"});setTimeout(function(){clearTimeout(refreshtimer);location.reload(true)},3000)}else{$.toaster({priority:"danger",title:"Connexion impossible",message:"Le login ou le mot de passe n'est pas valide"})}},})}else{$.toaster({priority:"danger",title:"Connexion impossible",message:"Il manque des informations pour vous connecter"})}});$("#logout").on("click",function(){$.ajax({url:"ajax/login/logout.php",type:"POST",async:true,success:function(c){$.toaster({priority:"success",title:"Déconnexion réussie",message:"Vous êtes maintenant déconnecté"});setTimeout(function(){clearTimeout(refreshtimer);location.reload(true)},3000)},})});$("#chgpass").on("click",function(){if($("#pass1").val()!=""&&$("#pass1").val()==$("#pass2").val()){$.ajax({url:"ajax/login/changepass_users.php",type:"POST",async:true,data:{Mdp:$("#mmdp").val()},dataType:"json",success:function(c){switch(c.data){case"ok":$.toaster({priority:"success",title:"Changement Mot de passe",message:" Réussi"});setTimeout(function(){clearTimeout(refreshtimer);location.reload(true)},3000);break;default:$.toaster({priority:"warning",title:"Changement Mot de passe",message:" Echec inattendu ! "})}},})}else{$.toaster({priority:"danger",title:"Changement Mot de passe",message:"les mots de passe ne sont pas identique !"})}});$('input[name="checkbox-refresh"]').on("switchChange.bootstrapSwitch",function(c,d){if(d==true){funcrefresh()}else{clearTimeout(refreshtimer)}});$("#setconfig").on("click",function(){if($("#langs").val()!=""&&$("#retcc").val()!=""&&$("#retcfr").val()!=""&&$("#retcfs").val()!=""&&$("#retcn").val()!=""&&$("#retcp").val()!=""&&$("#retjm").val()!=""){$.ajax({url:"ajax/env/setconfig.php",type:"POST",async:true,data:{langs:$("#langs").val(),retcc:$("#retcc").val(),retcfr:$("#retcfr").val(),retcfs:$("#retcfs").val(),retcn:$("#retcn").val(),retcp:$("#retcp").val(),retjm:$("#retjm").val()},dataType:"json",success:function(c){switch(c.data){case"ok":$.toaster({priority:"success",title:"Modification de la configuration",message:" Réussi"});setTimeout(function(){clearTimeout(refreshtimer);location.reload(true)},3000);break;default:$.toaster({priority:"warning",title:"Modification de la configuration",message:" Echec inattendu ! "})}},})}else{$.toaster({priority:"danger",title:"Modification de la configuration",message:"il manque des informations !"})}})});